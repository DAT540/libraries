<?
include "global.tbh"
dim params as string=sock.gethttprqstring(255)
dim table_name as string(TBL_MAX_TABLE_NAME_LEN)
dim index as byte=0

'get action param
dim action as string=http_server_find_param(params,"action")
dim param as string
dim result as string=""

select case action
case "get":
	dim table_type as string=http_server_find_param(params, "type")
	tbl_web_get_tables(table_type)
case "rows":
	table_name=http_server_find_param(params,"table")
	dim count as word=val(http_server_find_param(params,"count"))
	dim offset as word=val(http_server_find_param(params,"offset")) + 1
	tbl_web_get_rows(table_name)
case "add":
	table_name=http_server_find_param(params,"table")
	dim row as string=http_server_find_param(params,"row")
	result=tbl_web_add_row(table_name,row)
case "delete":
	table_name=http_server_find_param(params,"table")
	dim row as word=val(http_server_find_param(params,"row"))
	tbl_web_delete_row(table_name,row)
case "clear":
	table_name=http_server_find_param(params,"table")
	result=tbl_web_clear_table(table_name)
case "edit":
	table_name=http_server_find_param(params,"table")
	dim row as string=http_server_find_param(params,"row")
	dim index as word=val(http_server_find_param(params,"index"))
	result=tbl_web_edit_row(table_name,index,row)
case "get_field_default":
	table_name=http_server_find_param(params,"table")
	dim field_name as string=http_server_find_param(params,"field_name")
	result=tbl_web_get_field_def(table_name,field_name)
case else:
	
end select
sock.setdata(result)
sock.send()
?>
